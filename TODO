соображения по рефакторингу

1 ngrams проходит 2 раза: в токенайзере и в фильтре
  долен проходить один раз
2 блобы нужно каждый раз заново накатывать
3 нужно использовать parent-child feature
  parrent - project
  child - blobs, commits
  выбрать все коммиты проекта - has_parent_query